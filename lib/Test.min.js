var e=this.self||global;function f(a){this.a=a?a.clone():{}}function h(a,c){function d(){var a=b.shift();a&&a(g)}var b=Object.keys(a.a).map(function(b){return a.a[b]}),g=new j(b.length,function(a){c&&c(a)},{tick:d});d()}function k(){var a=location.href.split("/");a.pop();return a.join("/")+"/"}var j=e.Task||require("uupaa.task.js"),l="process"in e,m="WorkerLocation"in e,n="document"in e,p="console"in e;f.name="Test";f.repository="https://github.com/uupaa/Test.js";
f.swap=function(a,c){var d={b:a,name:a.name||""};c&&(e[d.name]=c);return d};f.undo=function(a){e[a.name]=a.b;return null};f.prototype.add=function(a){var c=this;a.forEach(function(a){c.a[a.name]=a});return this};
f.prototype.run=function(a){function c(){h(d,function(b){b?console.error("Browser error."):console.log("Browser ok.");document.body.style.backgroundColor=b?"red":"lime";Object.keys(d.a).forEach(function(a){if(!document.querySelector("#"+a)){var b=document.createElement("input");b.setAttribute("id",a);b.setAttribute("type","button");b.setAttribute("value",a+"()");b.setAttribute("onclick",a+"()");document.body.appendChild(b)}});a&&a(b,d)})}var d=this;n?(e.addEventListener("error",function(){document.body.style.backgroundColor=
"red"}),"complete"===document.readyState?c():e.addEventListener("load",c)):l?h(d,function(b){b?console.error("\u001b[31mNode error.\u001b[0m"):console.log("\u001b[32mNode ok.\u001b[0m");a&&a(b,d)}):m&&h(d,function(b){p&&(b?console.error("Worker error."):console.log("Worker ok."));b&&(e.errorMessage=b.message);a&&a(b,d)});return this};f.prototype.clone=function(){var a={},c;for(c in this.a)a[c]=this.a[c];return a};
f.prototype.worker=function(a,c){if(m||!("Worker"in e))a&&a(null,this);else{c=c||{};var d=this,b=c.src||"#worker";if("inline"===(c.type||"inline"))var g=document.querySelector(b),b=g&&"Blob"in e?(URL||webkitURL).createObjectURL(new Blob([g.textContent],{type:"application/javascript"})):"";b?(g=new Worker(b),g.onmessage=function(c){/^blob:/.test(b)&&(URL||webkitURL).revokeObjectURL(b);if(c=c.data.error)document.body.style.backgroundColor="red";a&&a(c?Error(c):null,d)},g.postMessage({baseDir:k()})):
a&&a(null,d);return this}};l&&(module.exports=f);e.Test?e.Test_=f:e.Test=f;
